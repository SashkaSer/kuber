# Домашнее задание к занятию "`Хранение в K8s. Часть 1`" - `Сергиенко А. В.`

### Задание 1 Cоздать Deployment приложения, использующего локальный PV, созданный вручную.

1. Создать Deployment приложения, состоящего из контейнеров busybox и multitool.
2. Создать PV и PVC для подключения папки на локальной ноде, которая будет использована в поде.
3. Продемонстрировать, что multitool может читать файл, в который busybox пишет каждые пять секунд в общей директории.
4. Удалить Deployment и PVC. Продемонстрировать, что после этого произошло с PV. Пояснить, почему.
5. Продемонстрировать, что файл сохранился на локальном диске ноды. Удалить PV. Продемонстрировать что произошло с файлом после удаления PV. Пояснить, почему.
6. Предоставить манифесты, а также скриншоты или вывод необходимых команд.  

Созданный Pod, PV и PVC
![podpvpvc](https://github.com/SashkaSer/kuber/blob/main/2.2/img/podpvpvc.png)`  

Видно, что multitool может читать данные из общей директории
![multi](https://github.com/SashkaSer/kuber/blob/main/2.2/img/mutli.png)`  

Удалили Deployment и PVC, PV остался. PV существует обособлено от пода и после удаления пода он продолжает существовать.
![multi](https://github.com/SashkaSer/kuber/blob/main/2.2/img/pvexist.png)`

После удаления PV данные остались на диске, так как используется политика Retain
![multi](https://github.com/SashkaSer/kuber/blob/main/2.2/img/deletepv.png)`
Манифесты к заданию 1 лежат в manifests/task1

---
### Задание 2 Создать Deployment приложения, которое может хранить файлы на NFS с динамическим созданием PV.

1. Включить и настроить NFS-сервер на MicroK8S.
2. Создать Deployment приложения состоящего из multitool, и подключить к нему PV, созданный автоматически на сервере NFS.
3. Продемонстрировать возможность чтения и записи файла изнутри пода.
4. Предоставить манифесты, а также скриншоты или вывод необходимых команд.

NFS-сервер на MicroK8S настроен согласно https://microk8s.io/docs/how-to-nfs

Как видно из скриншота PV создался автоматически через SC на сервере NFS
![createpvviasc](https://github.com/SashkaSer/kuber/blob/main/2.2/img/createpvviasc.png)`  

Видно, что multitool может читать данные из общей директории, а так же данный доступны локально на машине  
![datafromsc](https://github.com/SashkaSer/kuber/blob/main/2.2/img/datafromsc.png)`  

Манифесты к заданию 1 лежат в manifests/task2